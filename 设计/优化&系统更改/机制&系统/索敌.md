# 索敌机制
大致与原版一致，遵循加分索敌机制
## 优先级分数
单位或炮台的索敌，主要根据优先级算法，计算某个 **在攻击范围内**的目标的优先级分数。单位炮台会锁定分数最高的目标进行攻击。若遇到分数相同的情况，则随机选择其中一个为目标
### 算法
根据玩家或默认的优先级排序，若单位符合优先级的条件，就会给单位加不同的分数，优先级越高，加分越多  
大致分为8个优先级位次，每个位次的加分数从$2^8$→$2^1$依次指数递减，单位符合优先级条件或未设置优先级会给单位加分  
优先级分数$Y_n（n=1，2，3...）$  
总分$S$
$$S=\sum_{n=1}^8 Y_n$$
## 嘲讽机制
_不会对玩家“附身”的单位生效_  
嘲讽可以影响单位和炮台的索敌
### 名词概念
- 迷惑力（诱惑力）：单位和建筑的固有属性，用于描述对敌方目标的嘲讽能力，通常多数单位该值为零  
- 抗诱力：单位和炮台固有属性，用于描述抵抗被嘲讽的能力  
- 嘲讽度：由迷惑力计算而来的数据，与抗诱力直接对比
- 隐蔽力（Y）：单位炮台的固有属性，描述单位建筑的隐藏能力
_这些数值不会显示在面板上_
### 算法     
被迷惑对象索敌范围内出现施加迷惑的单位或建筑，才会进行下面的判断  
A为被迷惑对象，B为施加迷惑的对象
定义计算符号： 
- A的抗诱力→$K$（抗） 
- A的向量坐标→ $\vec{A}$
- A的移动速度向量或炮台的朝向向量→$\vec V$
- B的迷惑力→$M$（迷）     
- B的向量坐标→ $\vec{B}$   
- 嘲讽度→$C$（嘲）   
- 方向影响因素→$D$  
- 距离影响因素→$J$（距）
- AB相对方向→$\vec{C}$
- A的索敌范围→$F$（范） 
$$
\vec{C}=\vec{A}-\vec{B}\\
$$
$D$用cos计算方向因素
$$
D=\cos＜\vec{V},\vec{C}＞+2
$$
$J$的特殊算法，结合贝塞尔曲线计算  
具体参考下图，其中x轴为 $|\vec C|$（距离），轴为 $J$
![alt text](IMG_20240725_221610.jpg)
$A_1$点固定为（5($x_1$)，1.5）  
$A_4$点y轴固定为0，x轴为以下算法
$$
x_4=3\cdot\sqrt F+120
$$
$A_2$点y轴固定为1.5，x轴为以下算法
$$
x_2=\frac{2}{3}\cdot（x_4+x_1）
$$
$A_3$点y轴固定为0，x轴为以下算法
$$
x_3=\frac{1}{3}\cdot（x_4+x_1）
$$
嘲讽度算法
$$
C=D\cdot J\cdot M-K
$$
若C＞0，则给单位加分，反之则不加
## 限制级
在 $C＞0$时，限制级不生效
目标在符合任何限制级条件时，都不会索敌攻击
## 最终分数
最终分数$E$是单位炮台索敌的最终根据，公式：
$$
E=S+C-Y
$$
若 $E＜0$，则B不会被锁定