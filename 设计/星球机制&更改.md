# 星球机制&更改
## 1.势力辐射
 _(可以用做新游戏的规则设想)_
  
 **主线和支线关卡不受该机制影响**
1.  基地区块势力范围会辐射,根据不同的难度等级,有不同的辐射范围,以一个区块半径为一单位辐射范围:  

|难度  | 范围  |
|:---:|---| 
|低度&中度|1|
|高度&极高|2|
|毁灭|3|

2.  玩家初到被势力辐射的非基地区块,会进行防守,根据不同的辐射程度,会受到不同程度的难度定义,遵循一下规则:
- 所有区块的辐射难度,不超过最高的基地难度
- 将受势力辐射的程度,定义为威胁度,每种难度的敌方基地辐射的程度,随距离增大而减弱,具体:  

| 难度↓威胁度↘️半径→ | 半径0 | 半径1 | 半径2  | 半径3  |
| :---------- | --- | :-: | :--: | :--: |
| 低度&中度       | 1   |  1  | null | null |
| 高度&极高       | 2   |  2  |  1   | null |
| 毁灭          | 4   |  4  |  2   |  1   |
_根据威胁度计算难度：_  

|难度  | 低度  |中度|高度|极高|毁灭|
|:---:|:---:|:---:|:---:|:---:|:---:|
|威胁度|1|2|3|5|6|

- 若玩家到没有任何威胁度的区块,区块默认被直接占领  
- 若玩家占领了一个受势力辐射的区块，则可能会受到再次攻击，难度不会随着再次攻击的次数增加而增加
## 2.索敌机制
大致与原版一致，遵循加分索敌机制
### 优先级分数
单位或炮台的索敌，主要根据优先级算法，计算某个 **在攻击范围内**的目标的优先级分数。单位炮台会锁定分数最高的目标进行攻击。若遇到分数相同的情况，则随机选择其中一个为目标
#### 算法
根据玩家或默认的优先级排序，若单位符合优先级的条件，就会给单位加不同的分数，优先级越高，加分越多  
大致分为8个优先级位次，每个位次的加分数从$2^8$→$2^1$依次指数递减，单位符合优先级条件或未设置优先级会给单位加分  
优先级分数$Y_n（n=1，2，3...）$  
总分$S$
$$
S=\sum_{n=1}^8 Y_n
$$
### 嘲讽机制
_不会对玩家“附身”的单位生效_  
嘲讽可以影响单位和炮台的索敌，嘲讽在超过单位或炮台**抗诱力**的时候，攻击优先级会被覆盖，单位或炮台会的索敌会被转移到**嘲讽度**最高的单位
#### 名词概念
- 迷惑力（诱惑力）：单位和建筑的固有属性，用于描述对敌方目标的嘲讽能力，通常多数单位该值为零  
- 抗诱力：单位和炮台固有属性，用于描述抵抗被嘲讽的能力  
- 嘲讽度：由迷惑力计算而来的数据，与抗诱力直接对比
- 隐蔽力（Y）：单位炮台的固有属性，描述单位建筑的隐藏能力
_这些数值不会显示在面板上_
#### 算法     
被迷惑对象索敌范围内出现施加迷惑的单位或建筑，才会进行下面的判断  
A为被迷惑对象，B为施加迷惑的对象
定义计算符号： 
- A的抗诱力→$K$（抗） 
- A的向量坐标→ $\vec{A}$
- A的移动速度向量或炮台的朝向向量→$\vec V$
- B的迷惑力→$M$（迷）     
- B的向量坐标→ $\vec{B}$   
- 嘲讽度→$C$（嘲）   
- 方向影响因素→$D$  
- 距离影响因素→$J$（距）
- AB相对方向→$\vec{C}$
- A的索敌范围→$F$（范） 
$$
\vec{C}=\vec{A}-\vec{B}\\
$$
$D$用cos计算方向因素
$$
D=\cos＜\vec{V},\vec{C}＞+2
$$
$J$的特殊算法，结合贝塞尔曲线计算  
具体参考下图，其中x轴为 $|\vec C|$（距离），轴为 $J$
![alt text](IMG_20240725_221610.jpg)
$A_1$点固定为（5($x_1$)，1.5）  
$A_4$点y轴固定为0，x轴为以下算法
$$
x_4=3\cdot\sqrt F+120
$$
$A_2$点y轴固定为1.5，x轴为以下算法
$$
x_2=\frac{2}{3}\cdot（x_4+x_1）
$$
$A_3$点y轴固定为0，x轴为以下算法
$$
x_3=\frac{1}{3}\cdot（x_4+x_1）
$$
嘲讽度算法
$$
C=D\cdot J\cdot M-K
$$
若C＞0，则给单位加分，反之则不加
### 限制级
在 $C＞0$时，限制级不生效
目标在符合任何限制级条件时，都不会索敌攻击
### 最终分数
最终分数$E$是单位炮台索敌的最终根据，公式：
$$
E=S+C-Y
$$
若 $E＜0$，则B不会被锁定

## 3.伤害计算  
更换原版比较单调的伤害计算方法，使伤害的影响因素更为复杂  
### 伤害类型
伤害大体分为实弹伤害,激光伤害和特殊伤害
### 伤害增幅
特殊效果，可以提高对应类型伤害
### 暴击模式
每种炮台单位都有属于自己的暴击模式，在触发对应条件时，对目标造成暴击，暴击提供的伤害提升根据单位炮台来决定
### 抗性
单位建筑固有属性，描述单位建筑对
### 算法
定义计算符号：  
最终伤害 $D$  
基础伤害 $B$  
伤害增幅 $A$  
暴击伤害 $C$  
目标抗性 $R$  
目标护甲 $H$
$$
D=B\cdot (1+A)\cdot C\cdot(1-R)-H
$$
文字：
$$
最终伤害=基础伤害×（1+伤害增幅）×暴击倍率×（1-目标抗性）-目标护甲
$$

## 4.热量化
- 热量不再是一个实时的量，而是可以储存的，存储热的量叫热容量，简称热容
- 热容量是每个建筑的固有属性，就如液体容量一样
- 需热建筑效率计算：
$$
效率=\frac{当前热容量}{最大热容量}\cdot最大效率
$$
- 建筑工作时消耗热量的速率：
$$
耗热速率=效率\cdot100\%效率时的耗热速率
$$
- 消耗热的速率受温度和地块特性影响
## 5.基础环境系统
包括温度湿度光照等,这些都是一个区块的固有属性,根据现实的地理学来设计地区的温度湿度光照等,主要用于计算热量消耗,冷却液消耗和对[自生合金]的影响
### 温度
- 影响需热建筑,散热建筑和[自生合金]相关建筑单位
- 温度取决于区块的经纬度和地形地势,区块的一些地块会影响其他地块的温度,也是主要因素,之间呈加算关系 `如:岩浆块等等`
- 每个地块都有自己的温度数值,建筑会采集自己所占地块的平均作为数据,单位仅仅只采集自己几何中心的地块作为数据
- 天气会极大影响温度
#### 热交换能力
需热和散热建筑的固有属性
#### 热利用效率(温度系数)
计算热量的利用效率和冷却液消耗速率,根据当前温度有下图算法:  
定义计算符号:  
温度系数 $T$  
温度 $D$  
热交换能力$H$  
天气因素$W$
![[]]  
$$
T=F^H\cdot W 
$$
**对于需热建筑:**  
外部供热会受$T$的影响,算法:
$$
实际供热速率=外部供热 \cdot T
$$
**对于散热建筑:**  
消耗冷却液的速率受$T$影响,算法:  
$$
实际消耗速率=建筑原生消耗速率 \cdot T
$$
#### 地块供热
温度过高的地块会给建筑提供热量,与外部热量一起加算,算法:  
定义计算符号:  
供热量$H$  
温度$D$  
下图为算法
![[]]
### 湿度
与温度的影响因素类似
- 湿度同样取决于经纬度
### 光照
与原版一致,只是一些天气和地块会影响一些地方的光照
## 6.不可视域
通过控制光路，造出不可视领域，敌方多使用，纳米科技后

## 7.物品新增性质
### 1.密度
主要用于限制发射的物品量
### 2.精致度
也是用于限制发射，用低等级发射台发射会损毁精度高的产品通常来说精致度：  
`高次物品＞低次物品`

## 8.单位容量共享（待定）
更改原版的单位容量独立，现所有单位共享容量，而容纳较低等级单位的数量将翻3倍，同种单位过多，该单位需要的容纳量越多

## 9.核心更改
核心共有5等级之多，可能还会有更加高级的核心  
每种核心都对应着一种玩家操控单位_（以下称玩家单位）_    
在有对应核心的前提下，玩家可以自由选择自己需要的操作的单位  
不论拥有什么类型的核心，在核心等级2级以后，都可以选择并操控侦查无人机
### 核心专业化
即对核心分类，不同类别的核心有不同的主要功能，分为以下几种：
1. **仓库核心** _（工业核心）_   
- 物品容量较大，但能提供的单位容量较少，生命值适中
- 对应单位为建造型单位，其功能主要是建造，几乎没有攻击性，会被攻击，有治疗功能
2. **军事核心** _（重装核心）_  
- 物品容量较小，但能提供大量单位容量，生命值较高
- 对应单位为攻击型单位，其主要功能是临时防守，并不能作为很强的单位，强度低于目前等级，建造速度一般  
- 用该核心发射，可以携带单位，但这会占据部分核心物品容量
1. **前哨核心** _（前哨站）_  
- 建造速度快，物品容量小，不提供单位容量，生命值低
- 对应单位为侦查型单位，飞行高度高，不会被攻击，但建造速度甚至比攻击型单位弱，没有任何攻击性 *（在洞穴中无法使用该单位）*
### 核心功能化
1. 基础的核心自带电池和太阳能板，能给前期提供基础电量
2. 
## 10.行星发射系统
包括核心发射与发射台发射物品的更改和区块导弹的添加  

### 发射物品容量共享
- 发射核心不再是每种物品都可以发射最大上限，而是换成了质量，根据密度计算不同物质的质量来填充
- 发射台也是如此，换成质量，但低等级发射台因为不稳定，会导致损毁高精度的物品
### 核心发射井
一种辅助区块发射的建筑，分多个等级，有核心发射井这两种，一般前中期解锁，需要填充特定燃料来运作
- 可以提高携带物品的质量，但不能超过质量承载上限
- 可以提高发射距离，可以往更加远的地方发射
### 接收台
- 区块必须要用接收台来接收来自其他区块的物质，不然无法接收物质  
- 只有高级接收台才能接收高级发射台发来的物质，并向下兼容  
- 
### 发射井
用于发射区块导弹的建筑，比较耗材，但非常有效
### 势力影响
玩家向区块发射核心和物质时，会受到敌方基地区块“防空导弹”的拦截，不同难度的拦截效力不同，越高越有可能拦截成功
#### 对核心的影响
##### 1. 血量损耗  
若核心飞行途经敌方基地区块，会被攻击，降低核心血量  
若血量损耗到0，核心坠毁  
##### 2. 信号丢失
玩家可以向没有解锁的主线区块发射核心，但因强烈的信号干扰，核心在飞行过程中丢失信号  
#### 对发射台和发射井的影响 
- 丢包
若发射时途径敌方基地区块，会受到攻击，导致丢包   
#### 算法
根据发射区块和目的区块的威胁度计算百分比
##### 抗干扰力
核心和发射台/井固有属性，用于描述抵抗干扰的能力  
##### 算法
定义计算符号：  
威胁度 $W$  
抗干扰力 $K$  
环境因素 $H$  
导弹被拦截概率/丢包率/核心生命值损耗比率 $V$
$$
V=H\cdot（\frac {W-K}{W}+0.2）
$$
若 $V＞0$，则会生效，反之不会  
若 $V＞1$，“粉身碎骨”

## 11.存档创建
可以创建多个存档，可以实时切换  
创建存档时可以选择难度和对一些项目调整  
### 难度调整
共分为6等难度：体验 简单 普通 高难 炼狱 非凡  
在玩家通过了炼狱模式并触发一些特殊的机制后才能开启非凡难度   
难度会影响一些基本的数值和设计，包括血量 攻击 耗电量 建造时间（建筑和单位） 建造材料 效果持续时间 效果作用效果 天气影响程度等等
- 体验：主打短暂体验内容，关卡极其简单，甚至早期关卡仅用玩家操控单位就能过。很多建筑的数值都有很大下降，部分敌方单位的特殊ai也有削弱。建筑材料减半，建筑时间大幅度缩短，解密可以跳过
- 简单：新人玩家也可以速速上手的难度，数值有略微削减，后期关卡难度一般
- 普通：难度适中，作为我们作者能玩得比较舒服而简单的难度，但仍然需要一定的游戏理解才能通关。所有难度的调整，都是基于这一点来做调整的
- 高难：难度比较高，敌方数值有小幅度提升，恶劣天气发生频率小幅度提升（再小也基本是翻倍），建造材料增加，建造时间增加；我们作者，玩起来还比较得心应手的难度，需要比较丰富的游戏经验才能通关；所有附加的效果时间延长40%，包括增益和减益
- 炼狱：非常难的难度，每一关的通过都非常极限，我们作者都很难通关，二周目玩会舒服一点点，备好蓝图是能艰难地通关。敌方数值翻倍，建造时间翻倍，建造材料翻倍，减益效果时间翻倍而增益效果时间不翻倍，恶劣天气发生频率提高，天气效果对敌方的影响减小。
- 非凡：几乎没有人能通关的难度，我们作者就练前面的两关都过不了。敌方数值翻3倍，建造时间和材料翻倍，耗电量翻3倍，减益效果时间翻三倍，恶劣天气频发。不能使用发射台
### 其他项目
#### 开启作弊（？
## 12.效果系统
更为复杂的效果系统，包括：
- 改变建筑单位的基础数值
- 对附近单位建筑具有联动效果
- 对单位建筑的行为逻辑有影响
## 